<div class="register-container">
  <div class="register-card">
    <div class="register-header">
      <h1>‚ú® Crear Cuenta</h1>
      <p>Reg√≠strate para gestionar tus pagos personales</p>
    </div>

    <!-- Active Session Warning -->
    <div *ngIf="hasActiveSession" class="warning-badge">
      <span class="badge-icon">‚ö†Ô∏è</span>
      <div class="warning-content">
        <p><strong>Sesi√≥n activa detectada</strong></p>
        <p>Debes cerrar tu sesi√≥n actual para registrar una nueva cuenta</p>
        <button type="button" class="btn-logout-warning" (click)="logoutAndContinue()">
          üö™ Cerrar Sesi√≥n y Continuar
        </button>
      </div>
    </div>

    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" [class.disabled-form]="hasActiveSession">
      <div class="form-group">
        <label for="email">Correo Electr√≥nico</label>
        <input type="email" id="email" formControlName="email" class="form-control"
          [class.is-invalid]="email?.invalid && email?.touched" placeholder="tu@email.com">
        <div class="error-message" *ngIf="email?.invalid && email?.touched">
          <span *ngIf="email?.errors?.['required']">El correo es requerido</span>
          <span *ngIf="email?.errors?.['email']">Ingrese un correo v√°lido</span>
        </div>
      </div>

      <div class="form-group">
        <label for="password">Contrase√±a</label>
        <input type="password" id="password" formControlName="password" class="form-control"
          [class.is-invalid]="password?.invalid && password?.touched" placeholder="M√≠nimo 6 caracteres">
        <div class="error-message" *ngIf="password?.invalid && password?.touched">
          <span *ngIf="password?.errors?.['required']">La contrase√±a es requerida</span>
          <span *ngIf="password?.errors?.['minlength']">M√≠nimo 6 caracteres</span>
        </div>
      </div>

      <div class="form-group">
        <label for="confirmPassword">Confirmar Contrase√±a</label>
        <input type="password" id="confirmPassword" formControlName="confirmPassword" class="form-control"
          [class.is-invalid]="confirmPassword?.invalid && confirmPassword?.touched" placeholder="Repite tu contrase√±a">
        <div class="error-message" *ngIf="confirmPassword?.invalid && confirmPassword?.touched">
          <span *ngIf="confirmPassword?.errors?.['required']">Confirme su contrase√±a</span>
          <span *ngIf="confirmPassword?.errors?.['passwordMismatch']">Las contrase√±as no coinciden</span>
        </div>
      </div>

      <div class="form-group">
        <label for="dni">DNI *</label>
        <input type="text" id="dni" formControlName="dni" class="form-control"
          [class.is-invalid]="dni?.invalid && dni?.touched" placeholder="12345678" maxlength="8">
        <div class="error-message" *ngIf="dni?.invalid && dni?.touched">
          <span *ngIf="dni?.errors?.['required']">El DNI es requerido</span>
          <span *ngIf="dni?.errors?.['pattern']">Ingrese un DNI v√°lido (8 d√≠gitos)</span>
        </div>
      </div>

      <div class="form-group">
        <label for="firstName">Nombre *</label>
        <input type="text" id="firstName" formControlName="firstName" class="form-control"
          [class.is-invalid]="firstName?.invalid && firstName?.touched" placeholder="Juan">
        <div class="error-message" *ngIf="firstName?.invalid && firstName?.touched">
          <span *ngIf="firstName?.errors?.['required']">El nombre es requerido</span>
          <span *ngIf="firstName?.errors?.['pattern']">Solo se permiten letras</span>
        </div>
      </div>

      <div class="form-group">
        <label for="lastName">Apellido *</label>
        <input type="text" id="lastName" formControlName="lastName" class="form-control"
          [class.is-invalid]="lastName?.invalid && lastName?.touched" placeholder="P√©rez">
        <div class="error-message" *ngIf="lastName?.invalid && lastName?.touched">
          <span *ngIf="lastName?.errors?.['required']">El apellido es requerido</span>
          <span *ngIf="lastName?.errors?.['pattern']">Solo se permiten letras</span>
        </div>
      </div>

      <div class="form-group">
        <label for="phone">Tel√©fono (opcional)</label>
        <input type="text" id="phone" formControlName="phone" class="form-control"
          [class.is-invalid]="phone?.invalid && phone?.touched" placeholder="987654321" maxlength="9">
        <div class="error-message" *ngIf="phone?.invalid && phone?.touched">
          <span *ngIf="phone?.errors?.['pattern']">Ingrese un tel√©fono v√°lido (9 d√≠gitos)</span>
        </div>
      </div>

      <div class="error-message text-center" *ngIf="errorMessage">
        {{ errorMessage }}
      </div>

      <div class="success-message text-center" *ngIf="successMessage">
        {{ successMessage }}
      </div>

      <button type="submit" class="btn-primary" [disabled]="registerForm.invalid || loading">
        <span *ngIf="!loading">‚ú® Crear Cuenta</span>
        <span *ngIf="loading">
          <span class="spinner-small"></span> Creando cuenta...
        </span>
      </button>
    </form>

    <div class="register-footer">
      <p>¬øYa tienes cuenta? <a routerLink="/login">Inicia sesi√≥n</a></p>
    </div>

    <!-- Benefits Section -->
    <div class="benefits-section">
      <h3>Con tu cuenta podr√°s:</h3>
      <ul>
        <li>‚úÖ Crear y gestionar tus pagos</li>
        <li>‚úÖ Ver tu historial personal</li>
        <li>‚úÖ Consultar el estado de tus pagos</li>
        <li>‚úÖ Filtrar por fecha y categor√≠a</li>
      </ul>
    </div>
  </div>
</div>